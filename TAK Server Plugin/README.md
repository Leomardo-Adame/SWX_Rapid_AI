# TAK Server Plugin for MCS COP
## Requirements
TAK Server 4.1 (See TAK_Server_Configuration_Guide.pdf for installation instructions)

Installers available here:

https://artifactory.takmaps.com/ui/repos/tree/General/TAKServer

## Dev Environment
Visual Studio Code currently used as Code Editor for TAK Server Plugin (run gradlew clean ShadowJar on terminal)

Visual Studio used for RabbitMQ Client (.Net Core Console App)

## Overview
### Plugin Types
| Class | Type | Function |
| :--- | :--- | :--- |
| McsSenderPlugin | MessageSenderBase | Sends messages received from MCS COP (RabbitMQ and eventually Kafka) to TAK Server (and clients, federates and other plugins), using the TAK proto messaging format.|
| McsLoggerReceiverPlugin | MessageReceiverBase | Receives CoT messages from TAK Server and .|

### Message Format
TAK Server plugins use the TAK proto message format to send and receive messages. This data format applies the fast and efficient data encoding of Protocol Buffers to Cursor on Target (CoT). Information about the format and definitions:

https://git.takmaps.com/standards/takproto

### Plugin Configuration
Plugin options can be set in a customized in a YAML configuration file that is specific to each plugin. Plugin configuration files are copied to /opt/tak/conf/plugins. If it doesn't already exist, an empty configuration file will be generated for each plugin the first time it is run. The name of the plugin configuration file is the fully-qualified name of the plugin, appended with the extension .yaml. 

### Misc Items

Restart TAK Server to reload plugins.

```
sudo systemctl restart takserver
```

View plugin manager UI to see plugins loaded. This requires a client cert configured for admin access (see TAK Server configuration guide for information.)
```
https://<tak_server_hostname>:8443/Marti/plugins/
```

connect a local netcat client to see messages generated by sample sender plugin (unsecure input on port 8088 must be enabled - not for production use)
```
nc localhost 8088
```
